async function fetchTerms(){const r=await fetch('data/terms.json');return r.json()}function esc(s){return s.replace(/[&<>'"]/g,c=>({'&':'&amp;','<':'&lt;','>':'&gt;',"'":'&#39;','"':'&quot;'}[c]))}function hi(t,q){if(!q)return esc(t);const re=new RegExp('('+q.replace(/[.*+?^${}()|[\]\\]/g,'\\$&')+')','ig');return esc(t).replace(re,'<mark>$1</mark>')}function card(t,q){return `<div class='card glass'><h4>${hi(t.title,q)}</h4><p>${hi(t.definition||'',q)}</p></div>`}window.renderTerms=async function(q=''){const root=document.getElementById('results');const terms=await fetchTerms();const k=(q||'').trim().toLowerCase();const list=!k?terms:terms.filter(t=>(t.title+' '+(t.alias||[]).join(' ')+' '+t.definition).toLowerCase().includes(k));root.innerHTML=list.map(t=>card(t,k)).join('')||`<div class='card glass'><p>該当がありません。</p></div>`}